{
    "contents" : "setwd(\"C:/Users/Chang Yen-hsiu/Desktop/Second Semester/Financial Time Series/HW8\")\nRWR = read.csv(\"RWR.csv\")\nRWR = RWR[nrow(RWR):1,]\nRWR.price = data.frame(date=as.Date(RWR[,1]),price=RWR[,7])\nRWR.return = data.frame(date = as.Date(RWR.price[-1,1]),\n    return = log(RWR.price[-1,2])-log(RWR.price[-nrow(RWR.price),2]))  \n# Drop all returns in 2001\nRWR.return = RWR.return[RWR.return$date > \"2001-12-31\",]\nplot(RWR.return,type='l',main='RWR return')\n\n# Observe if there exists unit root in the ruturn series\nacf(RWR.return[,2],main='ACF of RWR Return')\nacf(RWR.return[,2]^2,main='RWR return squared')\npacf(RWR.return[,2],main='PACF of RWR Return')\nlibrary(fUnitRoots)\nadfTest(RWR.return[,2])\n\n# Compute AIC values\ncalaic = function(maxp,maxq){\n  aicm = matrix(NA,maxp+1,maxq+1)\n  for(p in 0:maxp){\n    for(q in 0:maxq){\n      aicm[p+1,q+1]=arima(RWR.return[,2],order=c(p,0,q))$aic\n    }\n  }\n  aicm\n}\noptions(digits=5)\ncalaic(6,6)\nas.vector(calaic(20,0))\nas.vector(calaic(0,20))\n\n# AR(p) on PACF\npar(mfrow=c(2,2))\npacf(RWR.return[,2],main='RWR return')\npacf(arima(RWR.return[,2],order=c(1,0,0))$residuals,main='AR(1)')\npacf(arima(RWR.return[,2],order=c(5,0,0))$residuals,main='AR(5)')\npacf(arima(RWR.return[,2],order=c(10,0,0))$residuals,main='AR(10)')\n\n# MA(p) on ACF\npar(mfrow=c(2,2))\nacf(RWR.return[,2],main='RWR return')\nacf(arima(RWR.return[,2],order=c(0,0,1))$residuals,main='MA(1)')\nacf(arima(RWR.return[,2],order=c(0,0,5))$residuals,main='MA(5)')\nacf(arima(RWR.return[,2],order=c(0,0,10))$residuals,main='MA(10)')\n\n# AR(p) Residual Squared\npar(mfrow=c(2,2))\nacf(RWR.return[,2]^2,main='RWR return squared')\npacf(RWR.return[,2]^2,main='RWR return squared')\nacf((arima(RWR.return[,2],order=c(1,0,0))$residuals)^2,main='AR(1) Residual Squared')\npacf((arima(RWR.return[,2],order=c(1,0,0))$residuals)^2,main='AR(1) Residual Squared')\nacf((arima(RWR.return[,2],order=c(5,0,0))$residuals)^2,main='AR(5) Residual Squared')\npacf((arima(RWR.return[,2],order=c(5,0,0))$residuals)^2,main='AR(5) Residual Squared')\nacf((arima(RWR.return[,2],order=c(10,0,0))$residuals)^2,main='AR(10) Residual Squared')\npacf((arima(RWR.return[,2],order=c(10,0,0))$residuals)^2,main='AR(10) Residual Squared')\n\n\nlibrary(fGarch)\nml = garchFit(~arma(1,0)+garch(1,1),data=RWR.return[,2],trace=F,include.mean=F) \nml\nml_res = ml@residuals\nml_res_std = ml@residuals/volatility(ml)\nm = garchFit(~garch(1,1),data=RWR.return[,2],trace=F)\nm_res = m@residuals\nm_res_std = m@residuals/volatility(m)\nsummary(m)\n\n# Compare the residuals and the standardized residuals of the mean equation\npar(mfrow=c(1,1))\nplot(m_res,type='l',main='Residuals')\nplot(m_res_std,type='l',main='GARCH(1,1) Std Residuals')\n\n# ACF\npar(mfrow=c(2,2))\nacf(m_res,main='Residual',ylim=c(-0.2,0.2))\nacf(m_res^2,main='Residual Squared',ylim=c(-0.2,0.5))\nacf(m_res_std,main='GARCH(1,1) Std Residual',ylim=c(-0.2,0.2))\nacf(m_res_std^2,main='GARCH(1,1) Std Residual Squared',ylim=c(-0.2,0.5))\n\n# PACF\npacf(m_res,main='Residual')\npacf(m_res^2,main='Residual Squared',ylim=c(-0.2,0.4))\npacf(m_res_std,main='GARCH(1,1) Std Residual')\npacf(m_res_std^2,main='GARCH(1,1) Std Residual Squared',ylim=c(-0.2,0.4))\n\n\n\n\n",
    "created" : 1431549344891.000,
    "dirty" : false,
    "encoding" : "ISO8859-1",
    "folds" : "",
    "hash" : "2189928041",
    "id" : "218DC2D7",
    "lastKnownWriteTime" : 1429037444,
    "path" : "C:/Users/Chang Yen-hsiu/Desktop/Second Semester/Financial Time Series/HW8/hw8_yc707_3.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}